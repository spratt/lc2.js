<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>LC-2 Assembly Language Documentation</title>
    <link rel="stylesheet" type="text/css"
          href="http://fonts.googleapis.com/css?family=Open+Sans" >
    <link rel="stylesheet" type="text/css" 
          href="http://spratt.github.io/EasyCSS/readabilitysans.css" />
    <link rel="stylesheet" type="text/css" 
          href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.22.0/codemirror.min.css" />
    <link rel="stylesheet" type="text/css" 
          href="docs/style.css" />
    <style type="text/css">
      .error {width: .8em;}
    </style>
  </head>
  <body>
    <h1>LC-2 Assembly Editor</h1>


    <p>
      <a href="index.html">&lt;- Back to the project index</a>
    </p>
    
    <p>
      <textarea id="editor"></textarea>
      <button id="assemble">Assemble</button>
      <select id="loader">
        <option value="asm/helloworld.asm">helloworld.asm</option>
        <option value="tests/reverse.asm">reverse.asm</option>
        <option value="tests/dumbadd.asm">dumbadd.asm</option>
        <option value="tests/justtest.asm">justtest.asm</option>
      </select>
      <span id="errors" style="float: right"></span>
      <br />
      <div id="lc2"></div>
    </p>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.22.0/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.22.0/mode/z80/z80.min.js"></script>
    <script src="lc2.js"></script>
    <script src="lexer.js"></script>
    <script src="lib.js"></script>
    <script src="lc2asm.js"></script>
    <script src="lc2editor.js"></script>
    <script src="lc2display.js"></script>
    <script>
      var errors = document.getElementById('errors');
      var editor = LC2.editorFromTextArea(document.getElementById('editor'));
      editor.onError = function(err) {
          errors.innerHTML = err.message + ' on line ' + err.line;
      };
      editor.onChange = function(change) {
          errors.innerHTML = '&nbsp;';
      };
      var lc2inst = new LC2;
      lc2inst.log = console.log;
      lc2inst.pc.val = parseInt('3000', 16);
      var display = lc2inst.displayFromDiv(document.getElementById('lc2'));
      display.update();
      function handleProgram(prg) {
          lc2inst.load_program(prg);
          display.update();
      }
      document.getElementById('assemble').addEventListener('click',function(){
          editor.assemble(handleProgram);
      });
      function loaderChange() {
          var path = loader.options[loader.selectedIndex].value;
          editor.setValue(lib.readFromURL(path));
          editor.assemble(handleProgram);
      }
      document.getElementById('loader').addEventListener('change',
                                                         loaderChange);
      loaderChange();
    </script>
  </body>
</html>
